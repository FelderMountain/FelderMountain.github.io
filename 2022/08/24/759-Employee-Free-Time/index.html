<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Insist on doing small things."><title>759. Employee Free Time | Pinkman Tech Space</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">759. Employee Free Time</h1><a id="logo" href="/.">Pinkman Tech Space</a><p class="description">Insist on doing small things, then witness the magic</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">759. Employee Free Time</h1><div class="post-meta">2022-08-24<span> | </span><span class="category"><a href="/categories/LeetCode-Notes/">LeetCode Notes</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.6k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 6</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><p>本质是merge intervals, merge完后, intervals间的空隙就是答案. 如何merge? 要么sort, 要么用PQ. 还有一个好方法就是sweep-line algo.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Interval&gt; <span class="title function_">employeeFreeTime</span><span class="params">(List&lt;List&lt;Interval&gt;&gt; schedule)</span> &#123;</span><br><span class="line">        <span class="comment">// (timestamp, scores)</span></span><br><span class="line">        TreeMap&lt;Integer, Integer&gt; timeScoresMap = <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (List&lt;Interval&gt; intervals : schedule) &#123;</span><br><span class="line">            <span class="keyword">for</span> (Interval interval : intervals) &#123;</span><br><span class="line">                timeScoresMap.put(interval.start, timeScoresMap.getOrDefault(interval.start, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">                timeScoresMap.put(interval.end, timeScoresMap.getOrDefault(interval.end, <span class="number">0</span>) - <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="type">int</span> <span class="variable">start</span> <span class="operator">=</span> -<span class="number">1</span>, scores = <span class="number">0</span>;</span><br><span class="line">        List&lt;Interval&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> time : timeScoresMap.keySet()) &#123;</span><br><span class="line">            scores += timeScoresMap.get(time);</span><br><span class="line">            <span class="keyword">if</span> (scores == <span class="number">0</span> &amp;&amp; start == -<span class="number">1</span>) &#123;</span><br><span class="line">                start = time;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (scores &gt; <span class="number">0</span> &amp;&amp; start != -<span class="number">1</span>) &#123;</span><br><span class="line">                ans.add(<span class="keyword">new</span> <span class="title class_">Interval</span>(start, time));</span><br><span class="line">                start = -<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个方法很妙. 这个algo叫做sweep-line algorithm. 我们这样规定: 到达一个interval的开端, 我们让score + 1, 到达一个interval的末端我们让interval - 1. 因为interval的开端总是小于等于interval的末端, 我们在任何时刻的score都是大于等于0的. 如果某个时刻的score小于0, 代表我们经历过的start小于经历过的end, 这是不可能的. 那么score等于0意味着什么呢? 意味着我们在某个时刻经历完了之前所有intervals, 在这个题里面表示干完了之前所有的活. 如果某个时刻的score等于0, 那就说明此时就是休息的开始. 那么到什么时候会停止呢? 直到在某个时刻score大于0了, 此时就是休息的结束. 上面的start标记着休息的开始. 之所以一开始让start等于-1是因为, 题目不允许负无穷到某个开始时刻去休息. 如果题目改成下届是0, 此时比如说所有的intervals最早也是在1时刻开始, 那么我们可以在[0, 1]这个时间段休息. 但是这道题不是, 于是一开始认为没有休息时间. 当某个时刻score &#x3D;&#x3D; 0时, 此时就是休息的开始, 我们让start &#x3D; time. 如果在某个时刻, score大于0且start不为0, 这表示休息的结束, 我们添加这段休息时间到ans中, 然后让start &#x3D; -1. 如果此时start不等于-1, 我们之后遇到score大于0时会无法区分我们是在工作时刻还是在休息结束时刻.</p>
<p>时间复杂度: O(nlogn) 因为用了treemap(log1 + log2 + log3 + … + logn收敛于nlogn)<br>空间复杂度: O(n) 一样还是用了treemap存n个intervals.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Interval&gt; <span class="title function_">employeeFreeTime</span><span class="params">(List&lt;List&lt;Interval&gt;&gt; schedule)</span> &#123;</span><br><span class="line">        PriorityQueue&lt;Interval&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;((a, b) -&gt; a.start - b.start);</span><br><span class="line">        schedule.forEach(e -&gt; pq.addAll(e));</span><br><span class="line">        List&lt;Interval&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="type">int</span> <span class="variable">freeTimeStart</span> <span class="operator">=</span> pq.peek().end;</span><br><span class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (pq.peek().start &lt;= freeTimeStart) &#123;</span><br><span class="line">                freeTimeStart = Math.max(freeTimeStart, pq.peek().end);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                ans.add(<span class="keyword">new</span> <span class="title class_">Interval</span>(freeTimeStart, pq.peek().start));</span><br><span class="line">                freeTimeStart = pq.peek().end;</span><br><span class="line">            &#125;</span><br><span class="line">            pq.poll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>其实不用管多少个员工之类的. 要的是所有的员工都能休息, 那就是在某个时间段大家都不工作, 如果都不工作, 给的这些intervals该merge的merge剩下的intervals就是空闲的时间. 感觉不太对劲? 反证法. 假设某个休息时刻是intervals merge完后不在剩下的intervals中. 那么必然在那些merge好的intervals中, 但是这些时刻至少有一个employee在工作, 因此休息时刻不可能出现在merge好的intervals中. 这证明了休息的intervals只可能出现在merge后剩余的空白intervals中. 那如果剩下的intervals可能不全是可以用来休息的. 假设有个interval它不能用来休息, 也就是有员工工作, 但是此时并没有员工的interval出现在这个空白区域, 于是不满足我们的假设. 综上merge好intervals剩下的空白intervals就是休息时刻.</p>
<p>具体怎么写码呢? 牵扯到merge intervals, 自然而然想到根据interval的start来sort一下. 于是想到了用PQ. 当然我们用个list把intervals都装里面然后最后直接sort一下也行. 时间复杂度都是O(nlogn). 然后我们假设pq顶部的end时间就是休息的开始. 如果后续有intervals和顶部的这个interval有交集, 那么我们就让end时间等于二者end的最大值. 只要有交集, end就不断更新, 直到某个interval的start大于这个end, 此时就可以休息, 休息时间段就是[此时的end, pq顶部的interval的start]. 休息好后, 然后我们把end重新设置为pq顶部的end, 继续这个merge的操作.</p>
<p>时间复杂度: O(nlogn)<br>空间复杂度: O(n) 因为把所有的intervals都装到了pq中.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;Interval&gt; <span class="title function_">employeeFreeTime</span><span class="params">(List&lt;List&lt;Interval&gt;&gt; schedule)</span> &#123;</span><br><span class="line">        PriorityQueue&lt;Pair&lt;Integer, Integer&gt;&gt; pq = <span class="keyword">new</span> <span class="title class_">PriorityQueue</span>&lt;&gt;(</span><br><span class="line">                (a, b) -&gt; schedule.get(a.getKey()).get(a.getValue()).start</span><br><span class="line">                        - schedule.get(b.getKey()).get(b.getValue()).start);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; schedule.size(); i++) &#123;</span><br><span class="line">            pq.offer(<span class="keyword">new</span> <span class="title class_">Pair</span>&lt;&gt;(i, <span class="number">0</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> <span class="variable">freeTimeStart</span> <span class="operator">=</span> schedule.get(pq.peek().getKey()).get(pq.peek().getValue()).end;</span><br><span class="line">        List&lt;Interval&gt; ans = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">while</span> (!pq.isEmpty()) &#123;</span><br><span class="line">            Pair&lt;Integer, Integer&gt; earliestStartPair = pq.peek();</span><br><span class="line">            <span class="type">Interval</span> <span class="variable">earliestStartInterval</span> <span class="operator">=</span> schedule.get(earliestStartPair.getKey()).get(earliestStartPair.getValue());</span><br><span class="line">            <span class="keyword">if</span> (earliestStartInterval.start &gt; freeTimeStart) &#123;</span><br><span class="line">                ans.add(<span class="keyword">new</span> <span class="title class_">Interval</span>(freeTimeStart, earliestStartInterval.start));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">int</span> <span class="variable">workTimeEnd</span> <span class="operator">=</span> earliestStartInterval.end;</span><br><span class="line">            <span class="keyword">while</span> (!pq.isEmpty() &amp;&amp; schedule.get(pq.peek().getKey()).get(pq.peek().getValue()).start &lt;= workTimeEnd) &#123;</span><br><span class="line">                Pair&lt;Integer, Integer&gt; currPair = pq.poll();</span><br><span class="line">                workTimeEnd = Math.max(workTimeEnd, schedule.get(currPair.getKey()).get(currPair.getValue()).end);</span><br><span class="line">                <span class="keyword">if</span> (currPair.getValue() + <span class="number">1</span> &lt; schedule.get(currPair.getKey()).size()) &#123;</span><br><span class="line">                    pq.offer(<span class="keyword">new</span> <span class="title class_">Pair</span>&lt;&gt;(currPair.getKey(), currPair.getValue() + <span class="number">1</span>));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            freeTimeStart = workTimeEnd;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们有个条件没有用到, 就是每个员工的工作时间是sort好的. 那么我们可以先添加K个intervals到pq中, 然后merge的过程还是一样. 只不过我们pop出一个interval后, 我们要把该员工后续的下一个interval放到pq中去. 如果后面没有就不放了. 这样我们也是按照interval的start从小到大来进行merge的.</p>
<p>本质就是按照interval的start排序, 从小到大来进行遍历. 我们这个approach也能保证从小到大遍历.</p>
<p>这样时间复杂度就变到了O(nlogk), 因为pq中最大就是k个元素.<br>空间复杂度变为: O(k)</p>
<p>但实际运行没有第二个步骤快.</p>
<p>这个想法是受到merge K lists&#x2F;arrays. 只要牵扯到k个的, 第一时间想到PQ哈哈哈哈哈.</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2022/08/25/59-Spiral-Matrix-II/">59. Spiral Matrix II</a><a class="next" href="/2022/08/24/907-Sum-of-Subarray-Minimums/">907. Sum of Subarray Minimums</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img src="/img/dark_side_of_the_moon.jpeg"/></a><p>Calm Patient Persistent</p><a class="info-icon" href="mailto:tongxinn@andrew.cmu.edu" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/FelderMountain" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://www.linkedin.com/in/tongxin-niu" title="LinkedIn" target="_blank" style="margin-inline:5px"> <i class="fa fa-linkedin-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Always-Review-Here/">Always Review Here</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode-Notes/">LeetCode Notes</a><span class="category-list-count">475</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Templates/">Templates</a><span class="category-list-count">17</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://leetcode.com/Pinkman_Ox/" title="Pinkman LeetCode" target="_blank">Pinkman LeetCode</a><ul></ul><a href="https://www.youtube.com/watch?v=PLIAp5nr0q0" title="Live Aid (Queen) [1985, London, Wembly Stadium]" target="_blank">Live Aid (Queen) [1985, London, Wembly Stadium]</a><ul></ul><a href="https://www.bilibili.com/video/BV15f4y1p7Gq?spm_id_from=333.337.search-card.all.click&amp;vd_source=36313f6ca20b47d3b8d1740651933b35" title="Hotel California (Eagles) [1994, Hell Freezes Over]" target="_blank">Hotel California (Eagles) [1994, Hell Freezes Over]</a><ul></ul><a href="https://www.youtube.com/watch?v=FcoUvu0mGog" title="Fade to Black (Metallica) [2018, Lincoln, NE]" target="_blank">Fade to Black (Metallica) [2018, Lincoln, NE]</a><ul></ul><a href="https://www.youtube.com/watch?v=Ly6ZhQVnVow" title="Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]" target="_blank">Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]</a><ul></ul><a href="https://www.youtube.com/watch?v=HUTbH6ywrXk" title="心を開いて (坂井泉水 - ZARD)" target="_blank">心を開いて (坂井泉水 - ZARD)</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Pinkman Tech Space.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>