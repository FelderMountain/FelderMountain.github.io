<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Insist on doing small things."><title>981. Time Based Key-Value Store | Pinkman Tech Space</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">981. Time Based Key-Value Store</h1><a id="logo" href="/.">Pinkman Tech Space</a><p class="description">Insist on doing small things, then witness the magic</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">981. Time Based Key-Value Store</h1><div class="post-meta">2022-08-19<span> | </span><span class="category"><a href="/categories/LeetCode-Notes/">LeetCode Notes</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 2k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 8</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><p>è¿™é“é¢˜TreeMapçš„åº”ç”¨åœºæ™¯.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TimeMap</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;Integer, Map&lt;String, String&gt;&gt; store;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        store = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, String value, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!store.containsKey(timestamp)) &#123;</span><br><span class="line">            store.put(timestamp, <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;());</span><br><span class="line">        &#125;</span><br><span class="line">        store.get(timestamp).put(key, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (store.containsKey(timestamp) &amp;&amp; store.get(timestamp).containsKey(key)) &#123;</span><br><span class="line">            <span class="keyword">return</span> store.get(timestamp).get(key);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> timestamp - <span class="number">1</span>; i &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (store.containsKey(i) &amp;&amp; store.get(i).containsKey(key)) &#123;</span><br><span class="line">                <span class="keyword">return</span> store.get(i).get(key);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<p>æˆ‘çš„ç¬¬ä¸€ç‰ˆç­”æ¡ˆ. ä½¿ç”¨çš„æ˜¯åŒå±‚hashmap.</p>
<p>è¿™é“é¢˜å­¦ä¹ Treemap.</p>
<p>æ—¶é—´å¤æ‚åº¦: O(n) nå°±æ˜¯æŸä¸ªtimestampçš„å€¼ç»™è¿›å», å‡å¦‚æ²¡æ‰¾åˆ°, å°±æŒ¨ä¸ªå¾€å‰æ‰¾, éå†ä¸€é.<br>ç©ºé—´å¤æ‚åº¦: O(n) næ˜¯æ‰€æœ‰setçš„æ“ä½œ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TimeMap</span> &#123;</span><br><span class="line">    Map&lt;String, TreeMap&lt;Integer, String&gt;&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, String value, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        map.putIfAbsent(key, <span class="keyword">new</span> <span class="title class_">TreeMap</span>&lt;&gt;());</span><br><span class="line">        map.get(key).put(timestamp, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!map.containsKey(key))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">ans</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        TreeMap&lt;Integer, String&gt; currentTreeMap = map.get(key);</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">floorKey</span> <span class="operator">=</span> currentTreeMap.floorKey(timestamp);</span><br><span class="line">        <span class="keyword">if</span> (floorKey != <span class="literal">null</span>) &#123;</span><br><span class="line">            ans = currentTreeMap.get(floorKey);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å°±æ˜¯çº¢é»‘æ ‘. æ¯ä¸ªnodeå­˜çš„æ˜¯é”®å€¼å¯¹æ„æˆçš„entry, æŒ‰ç…§keyçš„å¤§å°æ’åº(æˆ–è€…è‡ªå®šä¹‰æ’åºæ–¹æ³•, ä½¿ç”¨comparatoræ¥è¯´æ˜æ’åºæ–¹å¼). ç„¶åæˆ‘ä»¬å¯ä»¥åœ¨æ—¶é—´å¤æ‚åº¦ä¸ºO(logn)çš„å‰æä¸‹å–åˆ°æŸä¸ªç»™å®šçš„keyå¯¹åº”çš„value. æ¯”å¦‚é‚£ä¸ªTime Based Key-Value Storeé‚£é“é¢˜. æˆ‘æƒ³çš„æ˜¯æœ‰ä¸€ä¸ªhashmap, keyæ˜¯timestamp, valueå‘¢æ˜¯ä¸€ä¸ªhashmap, è¿™ä¸ªinner hashmapå­˜çš„æ˜¯æŸä¸ªtimestampä¸‹çš„string, stringè¿™æ ·çš„key value pair. ç°åœ¨çš„é—®é¢˜å°±æ˜¯å¦‚æœæˆ‘ä»¬æƒ³è¦å¾—åˆ°æŸä¸ªstringåœ¨æŸä¸ªtimestampä¸‹å¯¹åº”çš„value, é‚£è¯¥æ€ä¹ˆåŠå‘¢? æŒ‰ç…§æˆ‘çš„æ“ä½œ, å°±æ˜¯å…ˆçœ‹æœ‰æ²¡æœ‰è¿™ä¸ªtimestamp, æœ‰çš„è¯å†çœ‹åœ¨è¯¥timestampä¸‹æœ‰æ²¡æœ‰è¯¥stringä½œä¸ºkeyçš„KV pair. æ²¡æœ‰çš„è¯, ä»timestampå¼€å§‹å‘ä¸‹éå†(timestamp â€“ 1, timestamp -2â€¦ä¸€ç›´æ‰¾åˆ°timestampæ˜¯1çš„æƒ…å†µ, å› ä¸ºæœ€å°å°±æ˜¯1)å¤–éƒ¨çš„mapçš„timestamp, å»å¯»æ‰¾æ¯ç§timestampçš„inner mapæ˜¯å¦åŒ…å«è¯¥stringä½œä¸ºkeyçš„KV pair. è¿™æ ·å°±ä¼šå¾ˆæ…¢.</p>
<p>è¯•ç€æƒ³ä¸€ä¸‹å¦ä¸€ç§åµŒå¥—æ–¹å¼. ç”¨String-String pairçš„keyä½œä¸ºå¤–å±‚mapçš„key, å¤–å±‚mapå¯¹åº”çš„valueå‘¢æ˜¯ä¸€ä¸ªhashmap, inner hashmapåˆ™æ˜¯timestampå’Œstring-string pairä¸­çš„valueç»„æˆçš„pair. äºæ˜¯æˆ‘ä»¬ç»™å®šä¸€ä¸ªstring-string key value pairä»¥åŠtimestamp, æˆ‘ä»¬é¦–å…ˆçœ‹è¿™ä¸ªstring keyæ˜¯å¦å­˜åœ¨, ä¸å­˜åœ¨çš„è¯, ç­‰äºæ˜¯åœ¨ä»»ä½•timestampä¸‹éƒ½æ²¡æœ‰æ’å…¥è¿‡è¯¥string-string pair. å¦‚æœå­˜åœ¨, æˆ‘ä»¬æ‰¾åˆ°è¿™ä¸ªkeyå¯¹åº”çš„hashmap, è¿™ä¸ªmapä¸­å‘¢å­˜çš„æ˜¯å„ç§timestampä¸‹ä»¥è¯¥string keyå¯¹åº”çš„valueçš„å€¼. æ­¤æ—¶åˆæœ‰ä¸€ä¸ªé—®é¢˜, å¦‚æœåˆšå¥½æˆ‘ä»¬è¦çš„timestampå­˜åœ¨é‚£è¿˜å¥½, ç›´æ¥è®¿é—®åˆ°è¿”å›å³å¯, å¦‚æœæ²¡æœ‰å‘¢? å°±è¦éå†æ•´ä¸ªinner mapæ¥æ‰¾åˆ°æœ€æ¥è¿‘ç°åœ¨timestampå€¼çš„é‚£ä¸ªentry(è¯¥entryä¸­çš„timestampæœ€æ¥è¿‘æˆ‘ä»¬æƒ³è¦çš„timestamp, è¿™æ˜¯é¢˜ç›®çš„è¦æ±‚)äº†, å› ä¸ºè¿™ä¸ªhashmapçš„entryä¸æ˜¯æŒ‰ç…§timestampæ’å¥½åºçš„.</p>
<p>æ­¤æ—¶TreeMapå°±æ´¾ä¸Šç”¨åœºäº†. TreeMapå°±èƒ½æŠŠç»™å®šçš„é”®å€¼å¯¹æŒ‰ç…§é”®çš„å¤§å°(é”®çš„å¤§å°å¯ä»¥æ ¹æ®natural orderingä¹Ÿå¯ä»¥æ ¹æ®æˆ‘ä»¬æä¾›çš„comparator)æ¥æ’åºå¹¶ä¸”å¯ä»¥åœ¨log(n)æ—¶é—´è·å¾—æŸä¸ªkeyå¯¹åº”çš„value. äºæ˜¯å¦‚æœinner mapå­˜åœ¨æˆ‘ä»¬æƒ³è¦çš„timestamp, é‚£ä¹ˆç›´æ¥è·å–, å¦‚æœæ²¡æœ‰, é‚£ä¹ˆè·å–æ­¤æ—¶å­˜æœ‰çš„æœ€å¤§çš„timestampå³å¯. æ¯•ç«Ÿçº¢é»‘æ ‘å°±æ˜¯ä¸ªBST, é‚£ä¹ˆè·å–æ ‘ä¸­æœ€å¤§çš„timestampä¹Ÿå°±æ˜¯éœ€è¦log(n)æ—¶é—´.</p>
<p>é™¤äº†å¯ä»¥ä½¿ç”¨TreeMap, æˆ‘ä»¬è¿˜æœ‰åˆ«çš„æ–¹æ³•. æˆ‘ä»¬å¿½ç•¥äº†ä¸€ä¸ªç‚¹, å°±æ˜¯è¿™é“é¢˜æœ‰è¯´è¿‡timestampçš„å€¼æ˜¯ä¸ä¼šé€’å‡çš„. ä¹Ÿå°±æ˜¯åæ’å…¥çš„timestampä¸ä¼šæ¯”å‰é¢å°. ä¹Ÿå°±æ˜¯å¯¹äºæŸä¸ªKV pair, æˆ‘ä»¬å…ˆæ’å…¥K, V1(timestamp1), åæ’å…¥K, V2(timestamp2), timestamp2æ˜¯ä¸ä¼šå°äºtimestamp1çš„. äºæ˜¯æˆ‘ä»¬çš„inner mapå¯ä»¥æ¢æˆList. listä¸­å­˜çš„è¿˜æ˜¯timestamp-string pair, æŒ‰ç…§é¢˜ç›®çš„è¯´è¯, timestampåªä¼šè¶Šæ¥è¶Šå¤§ä¸ä¼šå˜å°, é‚£ä¹ˆè¿™ä¸ªlistå°±æ˜¯sortedäº†, å› ä¸ºæ˜¯å…ˆæ¥ååˆ°, å¯¹äºåŒä¸€ä¸ªstring keyåæ’å…¥çš„å°±ä¼šåœ¨listçš„åé¢. å¯¹äºsorted list, æƒ³è¦æŸ¥æ‰¾æŸä¸ªå€¼, binary searchå°±è‡ªç„¶è€Œç„¶è¢«æƒ³åˆ°äº†. å…ˆä½¿ç”¨binary searchæ‰¾æˆ‘ä»¬æƒ³è¦çš„timestamp, å¦‚æœæœ‰çš„è¯å°±è¿”å›å®ƒ, æ²¡æœ‰çš„è¯è¿”å›listä¸­æœ€åä¸€ä¸ªelementä¸­çš„valueå³å¯.</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ç¬¬63è¡Œçš„ifæ˜¯å¿…è¦çš„, å› ä¸ºgetå¯ä»¥éšä¾¿, æ¯”å¦‚æˆ‘æ’å…¥ä¸ªtimestampæ˜¯10, æˆ‘å–5, å¦‚æœæ²¡è¿™ä¸ªif, ç›´æ¥null pointer exceptionäº†. ä¸èƒ½ç›´æ¥è¿”å›currentTreeMap.get(floorKey), floorKeyå¯èƒ½ä¸ºnull.</p>
<p>æ—¶é—´å¤æ‚åº¦: O(logn)<br>ç©ºé—´å¤æ‚åº¦: O(n) næ˜¯setçš„ä¸ªæ•°.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TimeMap</span> &#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Data</span> &#123;</span><br><span class="line">        <span class="type">int</span> timestamp;</span><br><span class="line">        String value;</span><br><span class="line"></span><br><span class="line">        Data(<span class="type">int</span> timestamp, String value) &#123;</span><br><span class="line">            <span class="built_in">this</span>.timestamp = timestamp;</span><br><span class="line">            <span class="built_in">this</span>.value = value;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, List&lt;Data&gt;&gt; map;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">TimeMap</span><span class="params">()</span> &#123;</span><br><span class="line">        map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(String key, String value, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        map.putIfAbsent(key, <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;());</span><br><span class="line">        map.get(key).add(<span class="keyword">new</span> <span class="title class_">Data</span>(timestamp, value));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">get</span><span class="params">(String key, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!map.containsKey(key))</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">        List&lt;Data&gt; list = map.get(key);</span><br><span class="line">        <span class="keyword">return</span> binarySearch(list, timestamp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String <span class="title function_">binarySearch</span><span class="params">(List&lt;Data&gt; list, <span class="type">int</span> timestamp)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> list.size() - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="type">int</span> <span class="variable">middle</span> <span class="operator">=</span> left + (right - left) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (list.get(middle).timestamp == timestamp) &#123;</span><br><span class="line">                <span class="keyword">return</span> list.get(middle).value;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (list.get(middle).timestamp &lt; timestamp) &#123;</span><br><span class="line">                <span class="keyword">if</span> (list.get(middle + <span class="number">1</span>).timestamp &gt; timestamp)</span><br><span class="line">                    <span class="keyword">return</span> list.get(middle).value;</span><br><span class="line">                left = middle + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                right = middle - <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> list.get(left).timestamp &lt;= timestamp ? list.get(left).value : <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * binary searchçš„æ–¹æ³•.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * è¿™é‡Œæ¯”è¾ƒç‰¹åˆ«çš„æ˜¯å¦‚æœæ‰¾ä¸åˆ°æŸä¸ªtimestamp, æˆ‘ä»¬å°±è¦è¿”å›æ¯”è¿™ä¸ªtimestampå°çš„é‚£äº›entryä¸­timestampæœ€å¤§çš„</span></span><br><span class="line"><span class="comment">     * é‚£ä¸ªentry.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * é¦–å…ˆæˆ‘ä»¬è¦è®¨è®ºbinary searchæœ€åç»“æŸæ—¶ä¼šæ˜¯ä»€ä¹ˆæƒ…å†µ. å½“whileæ¡ä»¶æ˜¯left &lt;= rightæ—¶.</span></span><br><span class="line"><span class="comment">     * 1. left == right, è¦ä¹ˆleftç§»åŠ¨, è¦ä¹ˆrightç§»åŠ¨. æ ¹æ®æ­¤æ—¶leftå’ŒrightæŒ‡å‘çš„è¿™ä¸ªæ•°å­—å’Œtargetçš„å…³ç³». ç„¶åç»“æŸ.</span></span><br><span class="line"><span class="comment">     * 2. left != right, æ­¤æ—¶leftæŒ¨ç€right. å¦‚æœleftç§»åŠ¨, é‚£ä¹ˆè¿˜ä¼šç»§ç»­èµ°åˆ°left == rightçš„æƒ…å†µ,</span></span><br><span class="line"><span class="comment">     * å¦‚æœrightç§»åŠ¨, é‚£ä¹ˆç›´æ¥ç»“æŸ.</span></span><br><span class="line"><span class="comment">     * è¿™æ ·çœ‹å°±å¾ˆä¹±.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * é‚£ä¹ˆæˆ‘ä»¬è¯•ç€çœ‹çœ‹left &lt; rightçš„å¾ªç¯æ¡ä»¶.</span></span><br><span class="line"><span class="comment">     * é¦–å…ˆå°±æ˜¯leftå’ŒrightæŒ¨ç€, é‚£ä¹ˆå¦‚æœtargetæ¯”è¾ƒå¤§, å°±è¦ç§»åŠ¨left, ä½†æ˜¯å¦‚æœæ­¤æ—¶rightä¹Ÿä¸æ˜¯target, é‚£ä¹ˆæ­¤æ—¶çš„leftå°±æ˜¯</span></span><br><span class="line"><span class="comment">     * ç­”æ¡ˆ(æ¯”targetå°çš„æ‰€æœ‰æ•°å­—ä¸­æœ€å¤§çš„), å› æ­¤æˆ‘ä»¬åœ¨ç§»åŠ¨leftå‰å…ˆåˆ¤æ–­ä¸€ä¸‹middle + 1çš„å€¼. è¿™ä¹Ÿå°±æ˜¯ç¬¬149è¡Œçš„æ¥å†.</span></span><br><span class="line"><span class="comment">     * å¦ä¸€ç§æ˜¯left == rightè·³å‡ºå¾ªç¯, æ­¤æ—¶æˆ‘ä»¬åªéœ€è¦çœ‹æ­¤æ—¶æŒ‡å‘çš„å€¼æ˜¯å¦å°äºæˆ–è€…ç­‰äºtarget, å¦‚æœæ˜¯å°±è¿”å›, å¦‚æœä¸æ˜¯é‚£è¯´æ˜target</span></span><br><span class="line"><span class="comment">     * å¤ªå°äº†, æ²¡æœ‰æ¯”targetè¿˜å°çš„å€¼äº†, äºæ˜¯è¿”å›â€œâ€.</span></span><br><span class="line"><span class="comment">     * æœ€åä¸€ç§æ˜¯rightè¶…è¿‡leftè·³å‡ºå¾ªç¯, æ­¤æ—¶æ˜¯leftå’ŒrightæŒ¨ç€, right = middle - 1å¯¼è‡´.</span></span><br><span class="line"><span class="comment">     * æ­¤æ—¶çš„è¯æ˜¯targetæ¯”middleæŒ‡å‘çš„å°. æ­¤æ—¶leftå°±æ˜¯å°±æ˜¯æœ€æ¥è¿‘middleçš„å€¼äº†.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * ä¸Šé¢è¿™ä¸€å †è®¨è®ºå¾ˆéš¾è®°. è¿˜æœ‰ä¸€ä¸ªæ›´å¥½çš„æ–¹æ³•:</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">answer</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    List&lt;Pair&gt; values = map.get(key);</span><br><span class="line">    <span class="type">int</span> <span class="variable">left</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">right</span> <span class="operator">=</span> values.size() - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span>(left&lt;=right)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">middle</span> <span class="operator">=</span> left + (right - left) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (list.get(middle).timestamp == timestamp) &#123;</span><br><span class="line">            <span class="keyword">return</span> list.get(middle).value;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (list.get(middle).timestamp &lt; timestamp) &#123;</span><br><span class="line">            result = middle;</span><br><span class="line">            left = middle + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right = middle - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è¿™é‡Œå°±æ˜¯åœ¨middleæŒ‡å‘çš„æ•°å­—å°äºtargetçš„æ—¶å€™, æˆ‘ä»¬è®°å½•æ­¤æ—¶middleæŒ‡å‘çš„å€¼.</span></span><br><span class="line"><span class="comment"> * è¿™æ ·éšç€åŒºé—´çš„ç¼©å°, resultè®°å½•çš„å€¼å§‹ç»ˆå°äºtarget. ä¸€ç›´åˆ°æœ€åleft &gt; right</span></span><br><span class="line"><span class="comment"> * çš„æ—¶å€™, å¾ªç¯ç»“æŸçš„å‰ä¸€æ­¥å¯èƒ½æ˜¯:</span></span><br><span class="line"><span class="comment"> * leftå’ŒrightæŒ¨ç€, right = middle - 1. æ­¤æ—¶æ˜¯middleæ¯”targetå¤§, ä½¿å¾—rightå·¦ç§».</span></span><br><span class="line"><span class="comment"> * æ­¤æ—¶resultæ˜¯ä¸æ›´æ–°çš„æ²¡æ¯›ç—….</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * leftå’Œrighté‡åˆ, å¦‚æœleftç§»åŠ¨è¯´æ˜middleæ¯”targetå°, é‚£ä¹ˆè¦æ›´æ–°ä¸€ä¸‹resultçš„å€¼.</span></span><br><span class="line"><span class="comment"> * å¦‚æœrightç§»åŠ¨, è¯´æ˜middleæ¯”targetå¤§, ä¸æ›´æ–°result, æ²¡æ¯›ç—….</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * å› æ­¤æ˜¯æ¯æ¬¡åªè¦å‡ºç°middleæ¯”targetå°çš„æƒ…å†µ, æˆ‘ä»¬éƒ½è®°å½•ä¸‹æ¥. è¿™æ ·ä¼šè¶Šæ¥è¶Šé€¼è¿‘target.</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * è¿™ä¸ªæ¨¡æ¿è¦è®°ä¸‹æ¥.</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure></div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2022/08/19/994-Rotting-Oranges/">994. Rotting Oranges</a><a class="next" href="/2022/08/19/973-K-Closest-Points-to-Origin/">973. K Closest Points to Origin</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img src="/img/dark_side_of_the_moon.jpeg"/></a><p>Calm Patient Persistent</p><a class="info-icon" href="mailto:tongxinn@andrew.cmu.edu" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/FelderMountain" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://www.linkedin.com/in/tongxin-niu" title="LinkedIn" target="_blank" style="margin-inline:5px"> <i class="fa fa-linkedin-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Always-Review-Here/">Always Review Here</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode-Notes/">LeetCode Notes</a><span class="category-list-count">179</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Templates/">Templates</a><span class="category-list-count">13</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://leetcode.com/Pinkman_Ox/" title="Pinkman LeetCode" target="_blank">Pinkman LeetCode</a><ul></ul><a href="https://www.youtube.com/watch?v=PLIAp5nr0q0" title="Live Aid (Queen) [1985, London, Wembly Stadium]" target="_blank">Live Aid (Queen) [1985, London, Wembly Stadium]</a><ul></ul><a href="https://www.bilibili.com/video/BV15f4y1p7Gq?spm_id_from=333.337.search-card.all.click&amp;vd_source=36313f6ca20b47d3b8d1740651933b35" title="Hotel California (Eagles) [1994, Hell Freezes Over]" target="_blank">Hotel California (Eagles) [1994, Hell Freezes Over]</a><ul></ul><a href="https://www.youtube.com/watch?v=FcoUvu0mGog" title="Fade to Black (Metallica) [2018, Lincoln, NE]" target="_blank">Fade to Black (Metallica) [2018, Lincoln, NE]</a><ul></ul><a href="https://www.youtube.com/watch?v=Ly6ZhQVnVow" title="Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]" target="_blank">Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2022 <a href="/." rel="nofollow">Pinkman Tech Space.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>