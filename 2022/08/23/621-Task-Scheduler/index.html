<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Insist on doing small things."><title>621. Task Scheduler | Pinkman Tech Space</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">🌓</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">621. Task Scheduler</h1><a id="logo" href="/.">Pinkman Tech Space</a><p class="description">Insist on doing small things, then witness the magic</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">621. Task Scheduler</h1><div class="post-meta">2022-08-23<span> | </span><span class="category"><a href="/categories/LeetCode-Notes/">LeetCode Notes</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1.2k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 4</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">leastInterval</span><span class="params">(<span class="type">char</span>[] tasks, <span class="type">int</span> n)</span> &#123;</span><br><span class="line">        <span class="type">int</span>[] taskCount = <span class="keyword">new</span> <span class="title class_">int</span>[<span class="number">26</span>];</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; tasks.length; i++) &#123;</span><br><span class="line">            taskCount[tasks[i] - <span class="string">&#x27;A&#x27;</span>] += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Arrays.sort(taskCount);</span><br><span class="line">        <span class="type">int</span> <span class="variable">gaps</span> <span class="operator">=</span> (taskCount[taskCount.length - <span class="number">1</span>] - <span class="number">1</span>) * n;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> taskCount.length - <span class="number">2</span>; i &gt;= <span class="number">0</span> &amp;&amp; gaps &gt; <span class="number">0</span>; i--) &#123;</span><br><span class="line">            gaps -= Math.min(taskCount[taskCount.length - <span class="number">1</span>] - <span class="number">1</span>, taskCount[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> gaps &lt;= <span class="number">0</span> ? tasks.length : gaps + tasks.length;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这道题的思路是这样的. 我们先找到出现频率最高的jobs, 频率为fmax. 那么这些jobs之间肯定有fmax - 1个间隔. 这些间隔里面可以填充idle unit, 也可以填充其他job, 但是一定会有这么多间隔. 那么如果能够让其他的job把这些slots填满最好. 由于间隔时长是n, 那么一共有n * (fmax - 1)个slots等待被填充. 假设第一个间隔我们称为g1, 第二个间隔为g2…最后一个间隔为gn. 然后我们开始遍历每一种jobs, 看能不能把它们安排进这些slots中. 我们的原则是每种job, 它们是挨个填充每一个间隔. 比如来个job x, 出现m次. 那么第一个x在第一个间隔, 第二个x在第二个… 这就会有两种情况, 如果x的数量能把每一个间隔都放一个, 那么此时可能会剩下一个x或不剩下(因为x出现的频率可能和出现频率最高的那个job一样或者比它小), 这个剩下的先保留. 如果没填满, 那么下一种job接着往后填, 也就是不要直接再从第一个间隔开始. 比如上一种填到了第5个间隔, 那么就接着填第6个, 如果上一种填到了最后一个间隔, 那就从头开始填. 那这个第二种job有没有可能又来一遍每个间隔都有的情况呢? 有可能, 还是一样, 会剩下一个或者没有剩下, 剩下的就先保留. 按照这个思路填. 填到最后会有两种情况. 间隔全部都填满了, 此时每个间隔中没有相同类型的job. 现在剩下的jobs会有这两种情况. 一个是有些jobs压根还没安排, 还有就是之前有的jobs频率高, 会剩下一个. 没有安排上的jobs依旧按照上面说的规则去挨个插入每个间隔, 每个间隔都插入一种, 保证自己在每一个间隔都不会有重复. 剩余的那些因为频率高剩一个的, 统一放到最后去运行, 因为这些频率高的jobs都是不同的, 那么放在一起运行是没问题的.</p>
<p>我们来看一个例子.<br>比如[A A A A A B B B B B C C C D D D F E] n &#x3D; 2<br>开始就是先这样排(_表示待被填的slot):<br>A _ _ A _ _ A _ _ A _ _ A<br>然后开始插入B(每个间隔插一个):<br>A B _ A B _ A B _ A B _ A<br>此时剩下一个B放到最后:<br>A B _ A B _ A B _ A B _ A B<br>然后插入C:<br>A B C A B C A B C A B _ A B<br>然后插入D(不从头开始, 接着后面的间隔插入):<br>A B C | A B C | A B C | A B D | A B<br>此时空填完了, 但是还有jobs没有填完, 于是继续:<br>A B C D | A B C D | A B C F | A B D E | A B<br>也就是还是按照一个间隔插一个之后换下一个间隔插的原则. 这样永远不会出现一个间隔出现多个某一种job类型的情况. 那些高频率多出来的jobs统一放到最后运行. 频率再高也不会多出两个及以上, 它们顶多频率和A的一样, 要不然它们就会被选为最高频率的job了. 如果和A的频率一样高, 那么一个间隔填一个只会剩下一个.</p>
<p>综上, 我们首先算出至少有的间隔, 然后看能不能把间隔填满, 如果可以, 那么剩下的jobs按照我们之前提到的方法继续安排上(未安排的还是插空, 之前多出来的统一安排到最后运行), 这样我们就能保证最小. 如果间隔填不满, 那么只能是加上idle time. 这些最高频率jobs之间的间隔是一定有的, 间隔的数量是固定的, 但是长度最短就是n, 最大不限, 否则就违背题意.</p>
<p>时间复杂度: O(n)<br>空间复杂度: O(1) 因为我们就使用了一个固定长度为26的数组.</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2022/08/23/692-Top-K-Frequent-Words/">692. Top K Frequent Words</a><a class="next" href="/2022/08/23/572-Subtree-of-Another-Tree/">572. Subtree of Another Tree</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img src="/img/dark_side_of_the_moon.jpeg"/></a><p>Calm Patient Persistent</p><a class="info-icon" href="mailto:tongxinn@andrew.cmu.edu" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/FelderMountain" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://www.linkedin.com/in/tongxin-niu" title="LinkedIn" target="_blank" style="margin-inline:5px"> <i class="fa fa-linkedin-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Always-Review-Here/">Always Review Here</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode-Notes/">LeetCode Notes</a><span class="category-list-count">456</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Templates/">Templates</a><span class="category-list-count">17</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://leetcode.com/Pinkman_Ox/" title="Pinkman LeetCode" target="_blank">Pinkman LeetCode</a><ul></ul><a href="https://www.youtube.com/watch?v=PLIAp5nr0q0" title="Live Aid (Queen) [1985, London, Wembly Stadium]" target="_blank">Live Aid (Queen) [1985, London, Wembly Stadium]</a><ul></ul><a href="https://www.bilibili.com/video/BV15f4y1p7Gq?spm_id_from=333.337.search-card.all.click&amp;vd_source=36313f6ca20b47d3b8d1740651933b35" title="Hotel California (Eagles) [1994, Hell Freezes Over]" target="_blank">Hotel California (Eagles) [1994, Hell Freezes Over]</a><ul></ul><a href="https://www.youtube.com/watch?v=FcoUvu0mGog" title="Fade to Black (Metallica) [2018, Lincoln, NE]" target="_blank">Fade to Black (Metallica) [2018, Lincoln, NE]</a><ul></ul><a href="https://www.youtube.com/watch?v=Ly6ZhQVnVow" title="Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]" target="_blank">Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]</a><ul></ul><a href="https://www.youtube.com/watch?v=HUTbH6ywrXk" title="心を開いて (坂井泉水 - ZARD)" target="_blank">心を開いて (坂井泉水 - ZARD)</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2023 <a href="/." rel="nofollow">Pinkman Tech Space.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>