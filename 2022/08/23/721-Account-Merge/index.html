<!DOCTYPE html><html lang="en"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="Insist on doing small things."><title>721. Account Merge | Pinkman Tech Space</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=1.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/latest/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/pure-min.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/latest/grids-responsive-min.min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/latest/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/latest/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/latest/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/latest/toastr.min.css"><div class="darkmode-toggle">ğŸŒ“</div><script>var prefersDarkMode = window.matchMedia('(prefers-color-scheme: dark)');
var toggle = document.querySelector('.darkmode-toggle');
var html = document.querySelector('html');

html.dataset.dark = localStorage.dark || prefersDarkMode.matches;

toggle.addEventListener('click', () => {
localStorage.dark = !(html.dataset.dark == 'true');
html.dataset.dark = localStorage.dark;
});</script><meta name="generator" content="Hexo 6.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">721. Account Merge</h1><a id="logo" href="/.">Pinkman Tech Space</a><p class="description">Insist on doing small things, then witness the magic</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Home</i></a><a href="/archives/"><i class="fa fa-archive"> Archive</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">721. Account Merge</h1><div class="post-meta">2022-08-23<span> | </span><span class="category"><a href="/categories/LeetCode-Notes/">LeetCode Notes</a></span><script src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1k</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-clock-o"></i><span class="post-count"> 4</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="post-content"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ä¸æ¨èåˆ›å»ºä¸€ä¸ªNode classç„¶åé‡Œé¢è£…emailå’Œchildren. å› ä¸ºéœ€è¦è®©åŒä¸€ä¸ªé‚®ç®±ä¸é‡å¤åˆ›å»ºnode.</span></span><br><span class="line"><span class="comment"> * æ¯”å¦‚é‡åˆ°ä¸€ä¸ªnodeæ˜¯é‚®ç®±A, æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªnode, æˆ‘ä»¬ä¹‹åå¦‚æœå†æ¬¡é‡åˆ°ç›¸åŒçš„é‚®ç®±, å¦‚ä½•é¿å…é‡å¤åˆ›å»º</span></span><br><span class="line"><span class="comment"> * ä¸€ä¸ªnodeå‘¢? éœ€è¦ä¸€ä¸ªmapå­˜emailå’Œnodeçš„æ˜ å°„. é‚£è¿˜ä¸å¦‚å­˜emaiåˆ°è¯¥email childrençš„æ˜ å°„. ä¸€ä¸ª</span></span><br><span class="line"><span class="comment"> * entryå°±è¡¨ç¤ºä¸€ä¸ªnode.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> List&lt;List&lt;String&gt;&gt; <span class="title function_">accountsMerge</span><span class="params">(List&lt;List&lt;String&gt;&gt; accounts)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (accounts == <span class="literal">null</span> || accounts.size() == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        Map&lt;String, Set&lt;String&gt;&gt; emailNeighbors = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Map&lt;String, String&gt; emailNamePairs = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        Set&lt;String&gt; emails = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        List&lt;List&lt;String&gt;&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (List&lt;String&gt; account : accounts) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> account.get(<span class="number">0</span>);</span><br><span class="line">            emails.add(account.get(<span class="number">1</span>));</span><br><span class="line">            emailNamePairs.put(account.get(<span class="number">1</span>), name);</span><br><span class="line">            emailNeighbors.putIfAbsent(account.get(<span class="number">1</span>), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">2</span>; i &lt; account.size(); i++) &#123;</span><br><span class="line">                emailNeighbors.putIfAbsent(account.get(i), <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;());</span><br><span class="line">                emailNeighbors.get(account.get(i)).add(account.get(i - <span class="number">1</span>));</span><br><span class="line">                emailNeighbors.get(account.get(i - <span class="number">1</span>)).add(account.get(i));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Set&lt;String&gt; visited = <span class="keyword">new</span> <span class="title class_">HashSet</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (String email : emails) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!visited.contains(email)) &#123;</span><br><span class="line">                List&lt;String&gt; list = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">                helper(email, list, emailNeighbors, visited);</span><br><span class="line">                Collections.sort(list);</span><br><span class="line">                list.add(<span class="number">0</span>, emailNamePairs.get(email));</span><br><span class="line">                result.add(list);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">helper</span><span class="params">(String email, List&lt;String&gt; result, Map&lt;String, Set&lt;String&gt;&gt; neighbors, Set&lt;String&gt; visited)</span> &#123;</span><br><span class="line">        result.add(email);</span><br><span class="line">        visited.add(email);</span><br><span class="line">        Set&lt;String&gt; emailNeighbors = neighbors.get(email);</span><br><span class="line">        <span class="keyword">for</span> (String neighbor : emailNeighbors) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!visited.contains(neighbor)) &#123;</span><br><span class="line">                helper(neighbor, result, neighbors, visited);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æŠŠæ¯ä¸ªemailçœ‹ä½œæ˜¯node. åŒä¸€ä¸ªaccountä¸­çš„emailséƒ½æ˜¯äº’ç›¸reachableå¹¶æ„æˆä¸€ä¸ªgraphçš„, ä¹Ÿå°±æ˜¯å¯¹äºä¸€ä¸ªaccountä¸­çš„emails, ä»ä»»æ„ä¸€ä¸ªemailéƒ½èƒ½å¤Ÿåˆ°è¾¾å…¶ä»–æ‰€æœ‰çš„emails. emailä½œä¸ºnodeå°±å¯ä»¥ç”¨mapæ¥å­˜å‚¨: keyæ˜¯emailåå­—, valueæ˜¯ä¸ªset, é‡Œé¢å­˜çš„æ˜¯å…¶ä»–neighbro emailsçš„åå­—. è¿™æ ·å°±å¯ä»¥æä¾›ä¸€ä¸ªemailåå­—, ç„¶åçŸ¥é“å®ƒçš„neighbor nodeséƒ½æœ‰è°. æ­¤æ—¶ä¸€ä¸ªaccountå¯ä»¥çœ‹åšæ˜¯ä¸€ä¸ªgraph.</p>
<p>è¿™æ ·æˆ‘ä»¬åœ¨æ·»åŠ emailè¿›å…¥mapçš„æ—¶å€™, ä¸åŒçš„accountæœ‰ç›¸åŒemailçš„æ—¶å€™, ä¸åŒaccountä»£è¡¨çš„graphå°±è¯´æ˜æœ‰äº†å…±æœ‰çš„node, å› æ­¤ä¸¤ä¸ªgraphå°±ä¼šäº’ç›¸reachable(åœ¨ä¸€ä¸ªgraphä¸­çš„ä»»æ„ä¸€ç‚¹éƒ½å¯ä»¥åˆ°è¾¾å¦ä¸€ä¸ªgraphçš„ä»»ä½•ä¸€ç‚¹). ç­‰æˆ‘ä»¬è®°å½•å®Œæ‰€æœ‰accountçš„æ‰€æœ‰emailå, æˆ‘ä»¬æŠŠæ¯ä¸ªaccountä»£è¡¨çš„æ¯ä¸ªgraphè¿›è¡ŒDFS. å¦‚æœæœ‰ä¸¤ä¸ªæˆ–å¤šä¸ªgraphæœ‰å…±åŒnode, é‚£ä¹ˆæˆ‘ä»¬åœ¨DFSå…¶ä¸­ä¸€ä¸ªgraphçš„æ—¶å€™å°±ä¼šæŠŠå…¶ä»–graphä¸­çš„nodeséƒ½éå†åˆ°, ä»è€Œèµ·åˆ°åˆå¹¶çš„æ•ˆæœ. ä¸ºäº†ä¸èµ°é‡å¤ä»¥åŠé¿å…cycle, æˆ‘ä»¬éœ€è¦visitedè¿™ä¸ªsetæ¥å‘Šè¯‰æˆ‘ä»¬éƒ½èµ°è¿‡å“ªäº›node.</p>
<p>æˆ‘çš„å†™æ³•æ˜¯æ¯ä¸ªaccountçš„ç¬¬ä¸€ä¸ªemailä½œä¸ºè¯¥accountæ‰€ä»£è¡¨çš„graphçš„entry point. ä¸ºäº†å­˜å‚¨æ¯ä¸€ä¸ªaccountçš„ç¬¬ä¸€ä¸ªemail, æˆ‘ç”¨äº†ä¸€ä¸ªSet, è¿™æ˜¯å› ä¸ºä¸åŒçš„accountå¯èƒ½ç¬¬ä¸€ä¸ªemailæ˜¯ç›¸åŒçš„, ä½†æ˜¯å®ƒä»¬åç»­çš„emailså¯èƒ½æ˜¯ä¸åŒçš„. å¦‚æœentry pointæœ‰é‡å¤, æˆ‘ä»¬è®°å½•ä¸€æ¬¡å°±è¡Œ. ä¸é‡å¤è®°å½•.</p>
<p>æˆ‘åŒæ—¶éœ€è¦çŸ¥é“entry pointå¯¹åº”çš„user nameæ˜¯ä»€ä¹ˆ, å› ä¸ºè‚¯å®šæœ‰é‡åˆ°æŸä¸ªentry pointæ‰€å¯¹åº”çš„graphè¿˜æ²¡æœ‰è¢«éå†, æ­¤æ—¶å°±éœ€è¦ä»è¯¥entry pointå¼€å§‹æŠŠèƒ½åˆ°è¾¾çš„nodeéƒ½éå†, å¹¶ä¸”å­˜å…¥åˆ°ä¸€ä¸ªlistä¸­, æ­¤æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“è¿™ä¸ªgraphå¯¹åº”çš„äººçš„nameæ˜¯ä»€ä¹ˆ, å› æ­¤æˆ‘ç”¨ä¸€ä¸ªmapæ¥å­˜entry point, nameè¿™æ ·çš„KV pair.</p>
<p>æœ€åå°±æ˜¯æˆ‘ç”¨ä¸€ä¸ªmapæ¥å­˜æ‰€æœ‰é‡åˆ°è¿‡çš„emailçš„neigbors. å› ä¸ºåŒä¸€ä¸ªemailå¯èƒ½å‡ºç°åœ¨ä¸åŒçš„accountå¹¶ä¸”å®ƒä»¬æœ‰å…±åŒçš„neighors, å› æ­¤æˆ‘ä½¿ç”¨string, setè¿™æ ·çš„KV pairæ¥å­˜å‚¨æ¯ä¸ªnodeçš„neighbors.</p>
<p>è¿™é“é¢˜æœ‰ç‚¹å„¿æ„æ€.</p>
<p>Here NN is the number of accounts and KK is the maximum length of an account.</p>
<p>Time complexity: O(NKlogNK)</p>
<p>In the worst case, all the emails will end up belonging to a single person. The total number of emails will be N*K, and we need to sort these emails. DFS traversal will take NK operations as no email will be traversed more than once.</p>
<p>Space complexity: O(NK)</p>
<p>Building the adjacency list will take O(NK) space. In the end, visited will contain all of the emails hence it will use O(NK) space. Also, the call stack for DFS will use O(NK) space in the worst case.</p>
</div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2022/08/23/739-Daily-Temperatures/">739. Daily Temperatures</a><a class="next" href="/2022/08/23/692-Top-K-Frequent-Words/">692. Top K Frequent Words</a></div></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="author-info"><a class="info-avatar" href="/about/" title="About"><img src="/img/dark_side_of_the_moon.jpeg"/></a><p>Calm Patient Persistent</p><a class="info-icon" href="mailto:tongxinn@andrew.cmu.edu" title="Email" target="_blank" style="margin-inline:5px"> <i class="fa fa-envelope-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://github.com/FelderMountain" title="Github" target="_blank" style="margin-inline:5px"> <i class="fa fa-github-square" style="margin-inline:5px"></i></a><a class="info-icon" href="https://www.linkedin.com/in/tongxin-niu" title="LinkedIn" target="_blank" style="margin-inline:5px"> <i class="fa fa-linkedin-square" style="margin-inline:5px"></i></a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Categories</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Always-Review-Here/">Always Review Here</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/LeetCode-Notes/">LeetCode Notes</a><span class="category-list-count">225</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Templates/">Templates</a><span class="category-list-count">13</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> Links</i></div><ul></ul><a href="https://leetcode.com/Pinkman_Ox/" title="Pinkman LeetCode" target="_blank">Pinkman LeetCode</a><ul></ul><a href="https://www.youtube.com/watch?v=PLIAp5nr0q0" title="Live Aid (Queen) [1985, London, Wembly Stadium]" target="_blank">Live Aid (Queen) [1985, London, Wembly Stadium]</a><ul></ul><a href="https://www.bilibili.com/video/BV15f4y1p7Gq?spm_id_from=333.337.search-card.all.click&amp;vd_source=36313f6ca20b47d3b8d1740651933b35" title="Hotel California (Eagles) [1994, Hell Freezes Over]" target="_blank">Hotel California (Eagles) [1994, Hell Freezes Over]</a><ul></ul><a href="https://www.youtube.com/watch?v=FcoUvu0mGog" title="Fade to Black (Metallica) [2018, Lincoln, NE]" target="_blank">Fade to Black (Metallica) [2018, Lincoln, NE]</a><ul></ul><a href="https://www.youtube.com/watch?v=Ly6ZhQVnVow" title="Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]" target="_blank">Stairway To Heaven (Led Zeppelin) [1975, Live at Earls Court]</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright Â© 2022 <a href="/." rel="nofollow">Pinkman Tech Space.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=1.0.0" async></script><script type="text/javascript" src="/js/copycode.js?v=1.0.0" successtext="Copy Successed!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css?v=1.0.0"><script type="text/javascript" src="/js/codeblock-resizer.js?v=1.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=1.0.0"></script></div></body></html>